<html>
<head>

<!-- Make sure to change the title !!! -->

  <title>Matt McMunigle's Lab Notebook</title>
  <link rel="stylesheet" type="text/css" href="https://engineering.purdue.edu/ece477/MessageBoard/Lab_Notebook_Template.css" media="screen">

</head>
<body>

<!-- Make sure to change the name !!! -->

    <h1>Matt McMunigle's Notebook</h1>

    <h3 id="week01">Week 01</h3>

    <p class="entry"><b>January 15, 2014 (2 hour)</b>:<br>Met as a team to work on preliminary project proposal. 
    					Open source code was explored for projects similar to the proposed Every1 DJ design. </p>

    <p class="summary"><b>WEEK 01 SUMMARY</b><br>
                       <u>Accomplishments</u>: Submitted preliminary project proposal.<br>
                       <u>Weekly Work Total</u>: 2 hours<br>
                       <u>Project Work Total</u>: 2 hours</p>


    <h3 id="week02">Week 02</h3>
    
        <p class="entry"><b>January 22, 2013 (2 hour)</b>:<br>Created first draft of final project proposal. 
        Need to finalize PSSC and review draft with with team members. </p>
        
        <p class="entry"><b>January 23, 2013 (1.5 hour)</b>:<br>Began searching online for possible onboard
        computers to fill the need of our project. Initial decision was
        <a href="http://www.raspberrypi.org/">Raspberry Pi.</a> Documentation was reviewed to understand the
        capabilities and requirements of the rpi.   </p>      

    <p class="summary"><b>WEEK 02 SUMMARY</b><br>
                       <u>Accomplishments</u>: Submitted final project proposal<br>
                       <u>Weekly Work Total</u>: 3.5 hours<br>
                       <u>Project Work Total</u>: 6.5 hours</p>
                       
    <h3 id="week03">Week 03</h3>
		<p class="entry"><b>January 28, 2013 (2 hour)</b>:<br>Started Homework 2, PCB design exercise.
		During this activity a switching power supply circuit was duplicated using the National Semiconductor 
		LM2675. The transition from schematic to board proved difficult and needed the assistance of TA to complete. </p>

		<p class="entry"><b>January 39, 2013 (1.5 hour)</b>:<br> During weekly lab final PSSC's were informallly accepted. 
		A Raspberry Pi was ordered and should arrive within two days.</p>	
		
		<p class="entry"><b>January 30, 2013 (1 hour)</b>:<br>Homework 2 was completed with the help of the TA. </p>	
		
    <p class="summary"><b>WEEK 03 SUMMARY</b><br>
                       <u>Accomplishments</u>: Homework 2 - PCB Design <br>
                       <u>Weekly Work Total</u>: 4.5 hours<br>
                       <u>Project Work Total</u>: 11 hours</p>
   
               
    <h3 id="week04">Week 04</h3>
       		<p class="entry"><b>February 6, 2013 (1.5 hour)</b>:<br> Team meeting was held to complete Homework 3. 
   		During the meeting parts were decided upon and the majority of the assignment was completed. </p> 
   		
   		   	<p class="entry"><b>February 8, 2013 (3 hour)</b>:<br> Received Raspberry Pi from teammate and began
   		   	steps to load an OS. <a href="http://www.raspberrypi.org/downloads">New Out Of Box Software (NOOBS)</a> 
   		   	was loaded onto the formated SD card. <a href="http://www.raspbian.org/Raspbian"> Raspbian OS</a> was chosen based
   		   	on user reviews, capabilities and documentation. The OS was then installed and the RPI became functional!
   		   	The wifi configuration was modified and some time was spent exploring the existing applications. A HDMI to VGA
   		   	converter was purchased to avoid having to use living room tv. A USB hub was also purchased to allow a mouse and
   		   	keyboard to be used while the wifi dongle is attached.</p>   

    <p class="summary"><b>WEEK 04 SUMMARY</b><br>
                       <u>Accomplishments</u>: Completed Homework 3 and Raspberry Pi has OS loaded<br>
                       <u>Weekly Work Total</u>: 4.5 hours<br>
                       <u>Project Work Total</u>: 15.5 hours</p>
                       
                      
    <h3 id="week05">Week 05</h3>
       	
       		<p class="entry"><b>February 12, 2013 (2 hour)</b>:<br> During the required lab we reviewed our progress with Homework 4 and continued to finalized our parts list. 
       		It was pointed out by the TA's that the parts list was missing components related to power. After the discussion regulators and a power
       		supply were added to the list. Some components have been added and others will continue to be purchased. </p> 
       		
       		<p class="entry"><b>February 14, 2013 (1.5 hour)</b>:<br>  Homework 4 was thoroughly reviewed and modified after receiving some negative feedback on Homework 3.
       		Once the team was satisfied with the report and it had been turned in the attention was shifted to the test board provided by Joe. 
       		Time was spent reviewing a tutorial and online help for the MPLAB IDE. Unfortunately we did not have a power supply for the micro
       		during this time so there wasn't much of an accomplishment. The short term goal is communicate between the Raspberry Pi and Micro through
       		serial. </p> 
       		
       		<p class="entry"><b>February 15, 2014 (3 hours)</b>:<br>
      		After receiving the correct power supply from Joe it was time to set up the MPLAB IDE and attempt to run a test program on the micro.
      		Most of this time was spent reading online help forums trying to get the IDE to compile a program and recognize the MPLAB ICD 3 in-circuit debugger.
      		It was discovered that a separate C compiler must be installed and selected, instead of coming with the program as expected. The issue with the ICD 3
      		turned out to be diver incompatibility between different versions of the MPLAB ICD software. Finally, a test program was compiled and programmed on the micro.<br>
   		
    <p class="summary"><b>WEEK 05 SUMMARY</b><br>
                       <u>Accomplishments</u>: Homework 4 submitted <br>
                       <u>Weekly Work Total</u>: 6.5 hours<br>
                       <u>Project Work Total</u>: 22</p>
                       
    
    <h3 id="week06">Week 06</h3>
    
    <p class="entry"><b>February 19, 2014 (2.5 hours)</b>:<br>
      During mandatory lab session there were discussions with the course staff regarding the schematic and Homework 5 as a whole. 
      Work continued on the hardware narrative homework and individual sections were assigned within the group. Continuing from the success of
      getting MPLAB IDE successfully working the team created a test program to blink the LED's on the PIC development board. This may not be a huge
      accomplishment but it was exciting to finally see the microcontroller perform some 'action'. <br>
    	<a href="../images/mmcmunig/PIC_LED.JPG">
      		<img src="../images/mmcmunig/PIC_LED.JPG" alt="PIC Blinky" height="200px" width="200px">
        </a> <br>
    </p>

	<p class="entry"><b>February 20, 2014 (2 hours)</b>:<br>
	  Continued to work on Homework 5, hardware narrative. This included research on the communication data rates available between the microcontroller
	  and other components such as <a href="http://raspberrypi.stackexchange.com/questions/699/what-spi-frequencies-does-raspberry-pi-support">Raspberry Pi</a>
	   and the <a href="http://www.nxp.com/documents/data_sheet/PCA9626.pdf">LED Driver</a>. 

    <p class="entry"><b>February 21, 2014 (4 hours)</b>:<br>
      A team meeting was held to continue progress on the hardware narrative report. Much of the time was dedicated to coming to a consensus
      regarding the port assignments for each of the subsystems. It was decided that the internal oscillator would be used for the microcontroller
      and a frequency of 4MHz was chosen. Using scalers the appropriate clock speed will be attained for each of the peripherals. 
    </p>
    
    <p class="entry"><b>February 22, 2014 (2 hours)</b>:<br>
      Research was conducted to better understand the steps necessary to successfully stream a song using the GrooveShark API.
      It was discovered that Grooveshark is pretty strict on their licensing laws:
      <a href="http://developers.grooveshark.com/tuts/streaming">Grooveshark Streaming</a>. and an API key was requested. <br>
    
    <p class="entry"><b>February 23, 2014 (2 hours)</b>:<br>
      The Raspberry Pi was set up at the team station for our first test of the SPI ports. After once again struggling
      with the wifi adapter for the RaspberryPi an ethernet connection was established and the github repository was
      successfully cloned on the rpi. Using the SPI python walkthrough provided by  <a href="http://www.100randomtasks.com/simple-spi-on-raspberry-pi">100randomtasks.com</a>
      the serial ports showed some activity. No specific values were successfully read or written but that is the next goal.

    <p class="summary"><b>WEEK 06 SUMMARY</b><br>
                       <u>Accomplishments</u>: Raspberry Pi SPI has some output<br>
                       Schematic was completed for Homework 5<br>
                       <u>Weekly Work Total</u>: 12.5 hours<br>
                       <u>Project Work Total</u>: 34.5 hours</p>


    <h3 id="week07">Week 07</h3>

    <p class="entry"><b>February 24, 2014 (4 hours)</b>:<br>
    	After overcoming more problems with the MPLAB IDE software the SPI communication was tested using
    	predefined SPI write and read functions. When this was unsuccessful the functions were abandoned and
    	new code was written to manually check the SPI flags and fill the SPI buffer. <br>
        A header was soldered for the Raspberry Pi SPI pins in order to easily connect them to the PIC
        development board pins.  </p>
        
    <p class="entry"><b>February 25, 2014 (3 hours)</b>:<br>
      The focus of today's work session was once again to communicate between the microcontroller and the Raspberry Pi using SPI. 
      After confirming that the Raspberry Pi must be the master in the SPI master slave interface, a successful array of data was sent
      from the raspberry pi to the microcontroller and stored in a buffer. The signals were viewed using a logic analyzer to confirm the correct
      clock rate (62.5MHz) and the data being sent. <br>
            <a href="../images/jefferst/2014-02-25-serial-rpi.jpg">
	<img src="../images/jefferst/2014-02-25-serial-rpi.jpg" alt="rpi" height="200px" width="200px">
      </a>  <br>
      The setup that was used to test SPI communications:
      <br>
      <a href="../images/jefferst/2014-02-25-serial-comm-ckt.jpg">
	<img src="../images/jefferst/2014-02-25-serial-comm-ckt.jpg" alt="serial comm" height="200px" width="200px">
      </a> <br>      
    </p>


    <p class="entry"><b>February 26, 2014 (4 hours)</b>:<br>
      The lab discussion was concerned with audio streaming and API selection. Grooveshark's streaming
      API appears to be the best option however a session key is required by Grooveshark and it has
      been weeks without a reply from them. Other options were explored in the event that we are not
      able to use Grooveshark. These other options included paying for a spotify account in order to 
      use their streaming API, for downloading video's from youtube and using the audio from them. The latter
      is not preferred.  
    </p>

    <p class="entry"><b>February 27, 2014 (6 hours)</b>:<br>
      Upon inspection of the existing PCB layout, it was determined that all of the different voltages (3.3V, 5V, 12V) were connected together in the schematic and the PCB board. 
      This turned out to be a huge fix since nearly every power and ground trace need to be re-routed. The trace widths were changed for all power and 
      ground signals since previously they had all been set to 12 mil which is much to small for the amount of current required. It was discovered that 
      we had no connector for the power supply so the appropriate 3.5mm female connector was found in eagle and added to the layout. <br>
      The PCB board at the conclusion of the days work: <br>
      <a href="../images/mmcmunig/PCB_2_27.JPG">
	<img src="../images/mmcmunig/PCB_2_27.JPG" alt="block" height="200px" width="200px">   </a> <br>   
    </p>

    <p class="entry"><b>February 28, 2014 (8 hours)</b>:<br>
    	The goal of today was to complete the initial PCB layout required for Homework 06. In order to 
    	complete the board the BJT circuitry for the motor control was replaced by a 
    	<a href="http://www.ti.com/lit/ds/symlink/l293d.pdf">L239D Motor Driver</a>. The RJ-11 connector
    	needed to be connected to the programming pins of the microcontroller. Power and ground planes were
    	added to the board. Separate analog and digital ground planes were create in order to keep the signals
    	divided except for a single point. Finally power and ground pins needed to be routed to the existing 
    	bypass capacitors. 
      	The initial version of the PCB layout can be viewed below:<br>
      <a href="../images/jefferst/2014-03-01-PCB-layout.png">
	<img src="../images/jefferst/2014-03-01-PCB-layout.png" alt="block" height="200px" width="200px">
      </a> <br>
    </p>

    <p class="entry"><b>March 1, 2014 (1 hours)</b>:<br>
      A brief team meeting was held today to divide Design Review presentation subtasks.
    </p>

    <p class="summary"><b>WEEK 07 SUMMARY</b>
      <u>Accomplishments</u>:
      Meaningful communication from Raspberry Pi to microcontroller<br>
      PCB layout draft completed<br>
      <u>Weekly Work Total</u>: 29 hours<br> 34.5
      <u>Project Work Total</u>: 63.5 hours<br>
    </p>





    <h3 id="week08">Week 08</h3>    

    <p class="entry"><b>March 2, 2014 (1.5 hours)</b>:<br>
      Design review slides and presentation preparation. 
    </p>
    
    <p class="entry"><b>March 3, 2014 (7 hours)</b>:<br>
    	Last week data was successfully sent from the Raspberry Pi to the microcontroller via SPI.
    	Today the focus was to send data bidirectionally. After gaining a better understanding of the SPI
    	peripheral it was determined the SPI was being opened in the wrong mode. Once this was changed
    	there was a successful transfer of data to and from the microcontroller. It was also discovered that
    	the microcontroller uses the same buffer for sending and receiving SPI data.  
    	<br>
  		After the successful SPI transmission the focus was shifted to the schematic and pcb board. A 0 Ohm
		resistor was added between analog and digital ground. This allows the ground to stay separated during testing
		then joined together. Current limiting resistors were added between the LED driver and each of the LED header
		ins. The MPlab reference sheet was used to correctly connect the RJ-11 connector which will be used to program
		the microcontroller. A new power supply connector was created and added to the pcb board.
		<br>
		All of the parts that had been modified in the schematic were re-routed in the board. The power and ground
		trace widths were increased wherever possible. <br>
		Below was the state of the board at the completion of the night: <br>
    	<a href="../images/mmcmunig/3_3_PCB.JPG">
		<img src="../images/mmcmunig/3_3_PCB.JPG" alt="block" height="200px" width="200px">
		</a> <br>
      
    </p>

    <p class="entry"><b>March 4, 2014 (2 hours)</b>:<br>
      Design review practice and team meeting to discuss feedback from course staff and peers. 
    </p>

    <p class="entry"><b>March 5, 2014 (3 hours)</b>:<br>
      Updated PCB board with parts and connections that changed as a result of the design review. The ground plane that had
      been created was not named appropriately and therefore was not actually connected to ground. This was fixed as well as adding 
      rank to different planes in order to avoid overlapping.  <br>
      
      An LED was tested using a 5V input in order to determine if 100mA current would be enough for the 
      red, green, and blue LEDs. Using a piece of paper as eye protection the results were successful! 
    <br>
<a  href="../images/spouliqu/RedLED.jpg">
	<img src="../images/spouliqu/RedLED.jpg" alt="Red" height="200px" width="200px">
      </a>
<br><br>
<a href="../images/spouliqu/GreenLED.jpg">
	<img src="../images/spouliqu/GreenLED.jpg" alt="Green" height="200px" width="200px">
      </a>
<br><br>
<a href="../images/spouliqu/BlueLED.jpg">
	<img src="../images/spouliqu/BlueLED.jpg" alt="Blue" height="200px" width="200px">
      </a>
</p>

 
      
    </p>
    
    <p class="entry"><b>March 6, 2014 (3 hours)</b>:<br>
      Power components continue to change as we find new requirements that had previously been overlooked. The footprint of the bulk capacitors were
      much too small. <br>
      Audio drivers were installed on the Raspberry Pi. A few settings such as output volume and output device were modified. The audio originally
      is set to output from HDMI and this was changed to analog output. A wav file was downloaded and successfully played on powered speakers.
      When the oscilloscope was set up to view the output on headphone wires nothing but noise was heard. 
    </p>
                      
    <p class="entry"><b>March 7, 2014 (1 hours)</b>:<br>
      Went in with Courtney to discuss a few concerns with Joe. The audio amplifier design was modified in order to regulate the negative feedback.
      The footprint of a few power components (capacitor and inductor) were determined to be too small and will need to be changed.
    </p>  

    <p class="entry"><b>March 8, 2014 (2.5 hours)</b>:<br>
      A test circuit was set up for initializing the LCD. Online documentation on the NHD-2.23-12832UCB3 is limited but the 
      data sheet did provide the initialization sequence necessary to turn the LCD on. 
      <br>
<a href="../images/spouliqu/LCDCode.jpg">
	<img src="../images/spouliqu/LCDCode.jpg" alt="LCDCode" height="200px" width="200px">
      </a>
      After searching for open source code available online
      <a href="http://allaboutee.com/2013/01/26/pic18-explorer-board-lcd-spi-example-code/">Source Code</a>
       was found that provided a sample program to turn the LCD on and send data. Even after reading this the LCD was still
       not successfully turned on. </p>

    </p>  
    
    <h3 id="week08">Week 08</h3>

    <p class="summary"><b>WEEK 08 SUMMARY</b><br>
                       <u>Accomplishments</u>: LEDs were successfully tested at 5V 100mA<br>
                       SPI data was sent bidirectionally between Raspberry Pi and Microcontroller<br>
                       PCB board and schematic were updated as a result of design review<br>
                       <u>Weekly Work Total</u>: 19 hours<br>
                       <u>Project Work Total</u>: 82.5 hours</p>


    <h3 id="week09">Week 09</h3>

    <p class="entry"><b>March 9, 2014 (5 hours)</b>:<br>
      Worked on getting LCD to turn on and display anything.Each command was analyzed using the oscilloscope 
      and appeared to be sent correctly and in the right order. Was able to briefly get some random pixels to light
      up but even this stopped working. <br>
    	<a href="../images/mmcmunig/3_9_LCD_ON.JPG">
		<img src="../images/mmcmunig/3_9_LCD_ON.JPG" alt="block" height="200px" width="200px">  </a> <br>
	  It was discovered that the reason the screen lit up once earlier in the day but had appeared
      'off' since then was due to the entire RAM space in the LCD being initialized to 0. When the LCDwrite module tried to
      write a character the starting column and row were not reset to 0, but were instead at the very end of the RAM space 
      (not visible on the LCD). Once this was fixed the LCD was successfully initialized and data was displayed. <br>
        <a href="../images/mmcmunig/3_9_LCD_AHH.JPG">
		<img src="../images/mmcmunig/3_9_LCD_AHH.JPG" alt="block" height="200px" width="200px"> </a> <br>
    </p>
    
    <p class="entry"><b>March 11, 2014 (5 hours)</b>:<br>
      The schematic was updated with the final power and audio circuitry components. The component changes included
      using one stepper voltage regulator for 12V to 5V and one LDO for 5V to 3.3V. All of the bulk capacitors had been
      changed to correctly match the part footprint. The diodes were changed to surface mount. <br>
      Once these parts had been finalized on the schematic the board routing began. The layout of the voltage regulator
      followed the data sheet recommendation as closely as possible. The audio circuitry was kept compact and separate
      from the other components due to it having and anlog ground. The trace widths for power and ground were kept wide to 
      avoid overheating with the high current requirements. Vias were added to connect the ground plans on the top and 
      bottom. 
    </p>

    <p class="entry"><b>March 12, 2014 (2 hours)</b>:<br>
      During lab the current status of the PCB board and schematic were discussed with the course staff. Overall the results
      were positive. A few small changes were made including removing acute angles and adding a hole for a stabilizing piece
      on the underside of the dc power jack.  
    </p>
    
    <p class="entry"><b>March 13, 2014 (1 hours)</b>:<br>
      The board was submitted to the online checker. There was only one issue of a hole being too close to the ground plane. This issue
      was resolved and resubmitted through the online checker. Success! <br>
    <a href="../images/mmcmunig/3_13_PCB_No_Issues.JPG">
	<img src="../images/mmcmunig/3_13_PCB_No_Issues.JPG" alt="block" height="200px" width="200px">
      </a> <br>
      
    </p>
    
    <p class="entry"><b>March 14, 2014 (0.5 hours)</b>:<br>
      Went to the lab to finish the required checkoffs before submitting the PCB design. This included sending the course
      staff a .zip file of all the pcb files and board dimensions. The board should arrive the week after spring break.
    </p>
    
    <p class="summary"><b>WEEK 09 SUMMARY</b><br>
                       <u>Accomplishments</u>: The LCD was correctly initialized and displaying letters<br>
                        PCB board was completed and submitted for fabrication. <br>
                       <u>Weekly Work Total</u>: 13.5 hours<br>
                       <u>Project Work Total</u>: 96  hours</p>
                       
                       
    <h3 id="week10">Week 10</h3>

    <p class="summary"><b>WEEK 10 SUMMARY</b><br>
                       <u>Accomplishments</u>: No work was completed this work due to Spring Break.<br>
                       <u>Weekly Work Total</u>: 0 hours<br>
                       <u>Project Work Total</u>: 96 hours</p>
                       
    
    <h3 id="week11">Week 11</h3>

    <p class="entry"><b>March 23, 2014 (2 hours)</b>:<br>
     	A team meeting was held to review our current progress and to assign tasks going forward. Once the
     	managerial work was complete the commands sent between the Raspberry Pi and microcontroller via SPI 
     	were established. The Raspberry Pi will send a heartbeat message every 100ms(?). When a push button
     	microcontroller is pressed requesting a new song the microcontroller will load a Next Song Request character
     	into its SPI buffer. When the Raspberry Pi receives this special command character it will load the 
     	song meta data into its buffer to be send on the next 100ms transmission. The microcontroller will be expecting
     	the song data this time and will load the song name, artist, album, and year into global variables. These
     	global variables will be used to populate the LCD.		     	
    </p>

    <p class="entry"><b>March 24, 2014 (3 hours)</b>:<br>
    	The SPI testing circuit was reconstructed. Once bidirectional communication was confirmed
    	the correct interrupt registers were initialized in order to have the SPI communication fire the 
    	Interrupt Service Routine (ISR). Inside this ISR the LCD initialization module was called. The LCD
    	was not successfully turned on from this call.    
    </p>

    <p class="entry"><b>March 25, 2014 (4 hours)</b>:<br>
      The focus for today was to identify all of the registers necessary for the peripheral
      initializations. These peripherals include SPI, I2C, PWM, ADC, Timer, and Push Buttons. 
      The register bits were also identified for the necessary interrupts and flags. <br>  
      <a href="../images/mmcmunig/03_25_Registers.png">
	<img src="../images/mmcmunig/03_25_Registers.png" alt="block" height="200px" width="200px">
      </a> <br>   
    </p>
        
    <p class="entry"><b>March 26, 2014 (6.5 hours)</b>:<br>
      Today Meyer confirmed that our audio beat detection circuity appeared to be correct. This is where the
      good news ended as multiple pins were discovered to be routed incorrectly. The I2C clock and data pins were
      connected to general I/O pins instead of the specified locations. It was also discovered that Vss/Vdd were
      swapped in one location. After discussing the news with the team it was determined the pins could be manually
      re-routed and a new board might not be necessary.
      <br> 
      More bad news came when two different parts that were shipped during spring break did not match their 
      footprint on the PCB board. The correct version of the parts will need to be researched and ordered ASAP. 
    </p>
    
    <p class="entry"><b>March 27, 2014 (2 hours)</b>:<br>
		Continued working on adding content to the including expanding upon the register initializations and giving
		more details about how each of the peripherals behave and interact. 
	</p>
    
    <p class="entry"><b>March 28, 2014 (5 hours)</b>:<br>
      Work on the software narrative continued. Much of today was spent getting a better understanding of the ADC and PWM
      peripherals for our PIC18. Four PWM modules will be used in full-bridge mode to power the motor driver IC. The ADC module
      will sample the audio out from the Raspberry Pi a certain number of times and return the total over the time giving a value
      representing beats per minute. 
    </p>
    
    <p class="entry"><b>March 29, 2014 (6 hours)</b>:<br>
      Today's accomplishments were very disappointing for the amount of time spent. The goal of today was
      to finish up SPI testing and move on to I2C communication between the microcontroller and the LED driver.
      Once the test circuit was set up even simple communication between the Raspberry Pi and microcontroller were
      no longer working. After spending a great deal of time debugging it was determined that the oscilloscope 
      connecters were causing the signals to be tied high. It was not determined why this was the cause
      but once the connector was switched the communication was close to the expected output. It was also
      discovered that the ribbon cable made for our Raspberry Pi serial connectors had 1 pin that was not operating 
      correctly. Once these issues were dealt with the SPI communication was finally working again. However, the
      LCD was not operating as expected anymore. After unsuccessfully debugging the LCD connections I2C sample code
      was written but not tested yet. 
 	</p>
	
    <p class="summary"><b>WEEK 11 SUMMARY</b><br>
                       <u>Accomplishments</u>: SPI Bidirectional communication confirmed <br>
                       Necessary registers for peripheral and interrupts were determined<br>
                       I2C initialization and test code written<br>
                       <u>Weekly Work Total</u>: 22.5 hours<br>
                       <u>Project Work Total</u>:118.5 hours</p>
 
       
    <h3 id="week12">Week 12</h3>
                       
    <p class="entry"><b>March 30, 2014 (4 hours)</b>:<br>
      After yesterday's disappointing testing today was more productive. The reason for the LCD not working
      as expected was discovered to be 'noise' from the Raspberry Pi connections. Since all SPI share a clock
      this is a serious issue. Once the Raspberry Pi connector was unplugged the LCD was once again turing on and
      displaying characters. The LCD function was enhanced to allow strings as arguments from main. I2C communicaiton
      was tested today and after addressing a few issues was successful. The primary issue for I2C was having to clear
      the interrupt flag in software since it was not done in hardware like many other interrupts. <br>
    	<a href="../images/jefferst/2014-03-30-i2c.jpg">
		<img src="../images/jefferst/2014-03-30-i2c.jpg" alt="block" height="200px" width="200px">
      </a> <br>
      Finally the ADC module was written and tested. After reviewing the datasheet thoroughly the results of the 
      A/D conversion do not seem to be completely accurate. <br>
        <a href="../images/mmcmunig/3_30_ADC.png">
		<img src="../images/mmcmunig/3_30_ADC.png" alt="block" height="200px" width="200px">
		</a> <br>
 	</p> 
 	
 	<p class="entry"><b>April 2, 2014 (4 hours)</b>:<br> During mandatory lab it was decided that a new board would be design in order to fix 
 	issues with I2C connections and to recreate the audio circuit after testing. The audio circuit was tested and many issues were discovered with 	the gain and envelope detection. After deciding the LCD would now be controlled via I2C on the new PCB board layout, the LCD was successfully tested
 	using the I2C peripheral: 
 	
 	<br>
<a href="../images/spouliqu/LCD.jpg">
	<img src="../images/spouliqu/LCD.jpg" alt="LCD" height="200px" width="200px">
	</a>
</p>

    
	
	<p class="entry"><b>April 3, 2014 (6 hours)</b>:<br>  After working with the course staff the audio circuit was producing meaningful output.
	However, instead of using the envelop detection it was determined that the audio would simply be tested after the op-amp. The sensitivity of
	the beat detection can be modified through a potentiometer. The result can be viewed below.<br>
<a href="../images/spouliqu/Audio.jpg">
	<img src="../images/spouliqu/Audio.jpg" alt="Audio" height="200px" width="200px"> 
      </a>

<br> <br> Once the audio circuit was finalized the schematic and PCB were updated. The changes include the new audio circuit, changing
      LCD to I2C pins and fixing a ground power issue with a bypass capacitor. 
      

    <p class="summary"><b>WEEK 12 SUMMARY</b><br>
                       <u>Accomplishments</u>: ADC initialization and sampling code was written. The audio circuit was finalized
                       with meaningful output. A new schematic and board were created to fix multiple errors  <br>
                       <u>Weekly Work Total</u>:14  hours<br>
                       <u>Project Work Total</u>:132.5  hours</p>
                       
    
    <h3 id="week13">Week 13</h3>
    
    <p class="entry"><b>April 6, 2014 (3 hours)</b>:<br> A goal for this week is to prototype the LED driver. A basic test program was designed
    and coded to light up a single light. In order to successfully do this multiple control registers on the LED driver needed to be initialized 
    and the individual LED PWM register needed to be greater than 0. It was discussed that the group blinking and dimming registers would be used
    in the future once more LEDs were connected. 
    </p>

  
    
    <p class="entry"><b>April 7, 2014 (2 hours)</b>:<br> LED driver was soldered to a breakout board in order to begin prototyping. The soldered
    pin connections were not correct the first or second time and were corrected. After brief testing there was no noticeable light on the LED.
    </p>

    
    
    
    <p class="entry"><b>April 8, 2014 (3 hours)</b>:<br> Prototyping of the LED driver was resumed. After modifying the initialization of the 
    LED driver and still having no success, the I2C data and clock signals were scoped. The address signal was being ACK'd by the LED driver 
    but the other control signals were being NACK'd. </p>
    
    <p class="entry"><b>April 9, 2014 (5 hours)</b>:<br> The datasheet was further examined for the LED driver and a reset sequence was found and
    added to our initialization code. After the reset had been added, the microcontroller was now receiving ACKs for all commands sent to the 
    driver. However, even with the reset sequence the LED was still not turning on. The setup used to test the driver can be seen below:
    

<br><br>
<a href="../images/spouliqu/LEDDriverSetup1.jpg">
	<img src="../images/spouliqu/LEDDriverSetup1.jpg" alt="LEDDriver" height="200px" width="200px">
      </a>

 </p>


      
      <p class="entry"><b>April 10, 2014 (5 hours)</b>:<br>  The motor driver was wired up to a breadboard between the microcontroller and the motor wires. 
      A PLD was deemed necessary by the group and was programmed with a state machine corresponding to the coil combinations necessary to driver
      the motor. The output of the PLD was correct but after talking with Joe, our PCB layout did not allow for a PLD to be added after the driver. 
      In order to emulate the function of the PLD a state machine was added to the motor code. This state machine is updated based on a certain
      number of timer 2 interrupts. By varying the number of timer interrupts required before the state machine advanced to the next state allows
      the motor to spin at variable speeds. A video of the motor spinning can be seen below. 

<br>
      <br>
<a href="../images/spouliqu/MotorDriverSetup.jpg">
	<img src="../images/spouliqu/MotorDriverSetup.jpg" alt="LEDDriver" height="200px" width="200px">
      </a>
<br><br>
<video width="320" height="240" controls>
  <source src="../images/spouliqu/MotorSpinning.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</p>


      
      
      <p class="entry">
      <b>April 11, 2014 (4 hours)</b>:<br> The Reliability and Safety Analysis homework was completed. In order to complete this homework
      successfully the <a href = "https://engineering.purdue.edu/ece477/Course/Assignments/Reference/Mil_Hdbk_217F.pdf">Military Handbook</a> 
      was utilized
      as well as the individual component data sheets.   </p>

      

    <p class="summary"><b>WEEK 13 SUMMARY</b><br>
                       <u>Accomplishments</u>: LED commands are being ACKd by the LED driver. The motor driver was successfully rotating through
                       the use of a state machine on the microcontroller. The motor speed can be changed easily in software.  <br>
                       <u>Weekly Work Total</u>: 22 hours<br>
                       <u>Project Work Total</u>: 154.5 hours</p>


    <h3 id="week14">Week 14</h3>

		  
		<p class="entry"><b>April 14, 2014 (5 hours)</b>:<br> The heartbeat LED, RJ11 connector, bypass capacitors and microcontroller 
		were populated on the PCB. Once the ground and power were swapped on the incorrect bypass capacitor, the microcontroller was finally 
		tested. The result was an error stating a target device could not be found. After much testing, it was determined that the RJ11
		connector was designed backwards on the schematic/board. The connections were fly wired for testing purposes. The ICD3 could not
		find the device but was not able to get a valid device ID from the microcontroller. <br>
		The correct orientation of the RJ11 connector:
		<br><br>
<a href="../images/mmcmunig/RJ11_connector.jpg">
	<img src="../images/mmcmunig/RJ11_connector.jpg" alt="RJ11" height="200px" width="200px">
      </a>

 </p>


		 
		
		<p class="entry"><b>April 15, 2014 (5 hours)</b>:<br> Testing of the microcontroller continued today. The clock and data lines
		were scoped on the explorer board and compared to the same output from the microcontroller. The results appeared the same and did
		not provide much help in debugging. </p>

    
		  
		
		<p class="entry"><b>April 16, 2014 (5 hours)</b>:<br>The structure of SPI commands between the Raspberry Pi and microcontroller had 
		been established earlier time. Today these commands were implemented in both modules. The Raspberry Pi and microcontroller were
		successfully programmed and tested corresponding to each other's messages. The message structure is as follows: <br>
		RPI - Heartbeat - 0xAA <br>
		RPI - Song Data - 0xBB <br>
		Micro - Heartbeat  - 0x01 <br>
		Micro - Next Song  - 0x02 <br>
		Micro - Play/Pause - 0x03 <br> <br>
		
		This can be seen in the following code sample: <br>
		<br>
<a href="../images/mmcmunig/SPI_Commands.png">
		<img src="../images/mmcmunig/SPI_Commands.png" alt="RPI" height="200px" width="200px">
      </a>

<br></p>   
		
		<p class="entry"><b>April 18, 2014 (3 hours)</b>:<br>
      A new microcontroller was added to the PCB which validated the theory that the previous microcontroller was damaged.
      Once the LED driver was soldered the driver was once again but was still not showing meaningful output from the
      driver via I2C.
    </p>
		  

    <p class="summary"><b>WEEK 14 SUMMARY</b><br>
                       <u>Accomplishments</u>: Microcontroller and other components soldered to PCB board. SPI commands were programmed and successfully
                       tested. New microcontroller was successfully programmed. <br>
                       <u>Weekly Work Total</u>: 18 hours<br>
                       <u>Project Work Total</u>: 172.5  hours</p>
                       
    
    <h3 id="week15">Week 15</h3>

	<p class="entry"><b>April 21, 2014 (4 hours)</b> The motor driver and logic level translator have been soldered to the new PCB. After scoping
	each of the pins it was determined the OE pin on the level translator was tied high even though the datasheet specifies it as active low. 
	Now the output to the motor driver is correct but the motor is not rotating as expected. The motor header was re-soldered which fixed the issue. 
	The motor now spins smoothly in one direction. </p>

	<p class="entry"><b>April 22, 2014 (5 hours)</b> Now that the motor was working the focus was returned to the LED driver. The driver and pull-up
	resistors were soldered to the new PCB and a single LED was connected for testing. The oscilloscope was used to debug the signals being 
	sent to the LED driver. After fixing the initialization sequence, setting the PWM register for the correct LED, and setting the group
	brightness and period the LED finally was working! A video of the blinking LED can be seen below. <br>
      </a>
<br><br>
<video width="300" height="200" controls>
  <source src="../images/mmcmunig/LED_BLINKING.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</p>



	<p class="entry"><b>April 23, 2014 (4 hours)</b> The main goal for today is to get the LEDs to change blinking speed based on the ADC
	calculation from sampling the Raspberry Pi audio out. This would be accomplished by setting a threshold and counting the number of times
	the ADC was below this value during the sampling period. After playing around with the threshold and sampling period the blinking rate did
	respond to the number of beats but unfortunately it will be delayed due to the time it takes between samples. </p>
	
	<p class="entry"><b>April 26, 2014 (5 hours)</b> Today the SPI commands between the Raspberry Pi and microcontroller were modified to 
	interact with the web application. When the Raspberry Pi receives a new song request from the micro it sends a unique return code to the 
	web application. The web application then calls the SPI module with the top song title, artist, album, and year. The Raspberry Pi then sends
	this information to the microcontroller one byte at a time. Once the whole message has been received the update LCD function is called to show
	the new song information. A code snippet showing how the SPI module is called with newly parsed song data: <br>
		<br>
<a href="../images/mmcmunig/SPI_Code.png">
		<img src="../images/mmcmunig/SPI_Code.png" alt="LCD" height="200px" width="300px">
      </a>

<br>
	</p>

    <p class="summary"><b>WEEK 15 SUMMARY</b><br>
                       <u>Accomplishments</u>: Motor driver and motor are working on PCB board. LED driver was finally successfully written to 
                       and a single LED can blink. The SPI commands between the microcontroller and Raspberry Pi were integrated with the web
                       application. <br>
                       <u>Weekly Work Total</u>: 18 hours<br>
                       <u>Project Work Total</u>: 190.5 hours</p>


    <h3 id="week16">Week 16</h3>

	<p class="entry"><b>April 28, 2014 (6 hours)</b> When starting up the Raspberry Pi for the first time today the red power light did not 
	illuminate. The LDO, Fuse and a few capacitors got very hot after a short time. It was discovered that 3.3V and Ground were shorted at
	somewhere on the board. Unfortunately there were too many components to remove each of them and test which was causing the short. After 
	trying to replace the LDO and and shorting the fuse and still having no success the Raspberry Pi was determined to be dead. <br>
	The circled section of the RPI was determined to be the area where the short occurred:
		<br>
<a href="../images/mmcmunig/RPI_Failure.png">
		<img src="../images/mmcmunig/RPI_Failure.png" alt="RPI" height="200px" width="200px">
      </a>

<br></p>
	
	<p class="entry"><b>April 29, 2014 (5 hours)</b> Multiple local electronic stores were searched for a replacement Raspberry Pi but
	the only one available came in a $130 starter kit. Luckily multiple good samaritans offered up a Raspberry Pi for the team to borrow. Once
	the Raspberry Pi was back in operation another unfortunate part failure was discovered. Apparently whatever had cause the Raspberry Pi to 
	short also caused our microcontroller to need replaced. After a new microcontroller was soldered the project was finally back to where
	it had been two days before. Packaging was started and will be completed once the software is finalized. 
	<br>
<a href="../images/mmcmunig/packaging.jpg">
		<img src="../images/mmcmunig/packaging.jpg" alt="Packaging" height="200px" width="200px">
      </a>

<br>
	  </p>
	
	<p class="entry"><b>April 29, 2014 (7 hours)</b> With the microcontroller and Raspberry Pi both operational it was now time to focus on
	getting all of the peripherals to work simultaneously. There were multiple issues that needed resolved. The main problem was that functions
	taking a significant amount of time, such as the LCD or receiving song information via SPI, kept getting interrupted by the faster timer 
	interrupts. This was fixed by turning off all interrupts before going into these subroutines and turning them back on at the end of the
	isr. Once all of the peripherals were working the final packing was completed and the Every1 DJ was ready to entertain! 
	<br>
<a href="../images/mmcmunig/Every1DJ.png">
		<img src="../images/mmcmunig/Every1DJ.png" alt="Every1 DJ" height="200px" width="200px">
      </a>

<br>
	</p>
	
	<p class="entry"><b>May 2, 2014 (4 hours)</b>
      The IP configuration of the microcontroller was modified in an attempt to establish a local connection by connecting directly to a laptop. 
      This was done because no ethernet ports were available in the display area. The server was run on the laptop but was not accessible to anyone
      else on the network during the Design Showcase.<br>
    </p>

    <p class="summary"><b>WEEK 16 SUMMARY</b><br>
                       <u>Accomplishments</u>: All peripherals were tested successfully together. Final packaging was completed. Every1 DJ is complete!<br>
                       <u>Weekly Work Total</u>: 22 hours<br>
                       <u>Project Work Total</u>: 210.5 hours</p>                           

<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	END OF NOTEBOOK SECTION, BEGIN NAVBAR.  Do not change anything beyond this point.
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
-->
  <div id="navbar">
    <p>
      <b>DIRECTORY</b><br><br>
      <a href="#week01">Week 01</a><br>
      <a href="#week02">Week 02</a><br>
      <a href="#week03">Week 03</a><br>
      <a href="#week04">Week 04</a><br>
      <a href="#week05">Week 05</a><br>
      <a href="#week06">Week 06</a><br>
      <a href="#week07">Week 07</a><br>
      <a href="#week08">Week 08</a><br>
      <a href="#week09">Week 09</a><br>
      <a href="#week10">Week 10</a><br>
      <a href="#week11">Week 11</a><br>
      <a href="#week12">Week 12</a><br>
      <a href="#week13">Week 13</a><br>
      <a href="#week14">Week 14</a><br>
      <a href="#week15">Week 15</a><br>
      <a href="#week16">Week 16</a><br>
    </p>
  </div>
</body>
</html>

